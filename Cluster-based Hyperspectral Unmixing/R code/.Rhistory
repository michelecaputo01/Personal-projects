plot(c(-1,0,1,-1,0,1),c(0,0,0,1,1,1), lwd = 2, pch = 19,
xlim = c(-1.5,1.5), ylim = c(-0.5, 1.5), asp = 1, ylab = "", xlab = "", axes = FALSE)
axis(1, at = -2:2)
axis(2, at = -1:1)
box()
lines(c(-3,3), c(0,0))
plot(c(-1,0,1,-1,0,1),c(0,0,0,1,1,1), lwd = 2, pch = 19,
xlim = c(-1.5,1.5), ylim = c(-0.5, 1.5), asp = 1, ylab = "", xlab = "", axes = FALSE)
axis(1, at = -2:2)
axis(2, at = -1:1)
box()
lines(c(-3,3), c(0,0), lty = 2)
plot(c(-1,0,1,-1,0,1),c(0,0,0,1,1,1), lwd = 2, pch = 19,
xlim = c(-1.5,1.5), ylim = c(-0.5, 1.5), asp = 1, ylab = "", xlab = "", axes = FALSE)
axis(1, at = -2:2)
axis(2, at = -1:1)
box()
lines(c(-3,3), c(0,0), lty = 2, lwd = 0.3)
lines(c(-3,3), c(1,1), lty = 2, lwd = 0.3)
lines(c(0,0), c(-3,3), lty = 2, lwd = 0.3)
lines(c(-3,3), c(0,0), lty = 2, lwd = 0.3)
lines(c(-3,3), c(1,1), lty = 2, lwd = 0.3)
lines(c(0,0), c(-3,3), lty = 2, lwd = 0.3)
lines(c(1,1), c(-3,3), lty = 2, lwd = 0.3)
lines(c(-1,-1), c(-3,3), lty = 2, lwd = 0.3)
lines(c(-1,1), c(0,0), lwd = 2, lty = 1)
lines(c(-1,1), c(0,0), lwd = 3, lty = 1)
lines(c(0,1), c(0,1), lwd = 3, lty = 1)
lines(c(0,-1), c(0,1), lwd = 3, lty = 1)
lines(c(0,0), c(0,1), lwd = 3, lty = 1)
plot(c(-1,0,1,-1,0,1),c(0,0,0,1,1,1), lwd = 2, pch = 19,
xlim = c(-1.5,1.5), ylim = c(-0.5, 1.5), asp = 1, ylab = "", xlab = "", axes = FALSE)
axis(1, at = -2:2)
axis(2, at = -1:1)
box()
lines(c(-3,3), c(0,0), lty = 2, lwd = 0.2)
lines(c(-3,3), c(1,1), lty = 2, lwd = 0.2)
lines(c(0,0), c(-3,3), lty = 2, lwd = 0.2)
lines(c(1,1), c(-3,3), lty = 2, lwd = 0.2)
lines(c(-1,-1), c(-3,3), lty = 2, lwd = 0.2)
lines(c(-1,1), c(0,0), lwd = 3, lty = 1)
lines(c(0,1), c(0,1), lwd = 3, lty = 1)
lines(c(0,-1), c(0,1), lwd = 3, lty = 1)
lines(c(0,0), c(0,1), lwd = 3, lty = 1)
lines(c(0,4), c(0,2))
lines(c(0,4), c(0,2), lwd = 2, lty = 1)
plot(c(-1,0,1,-1,0,1),c(0,0,0,1,1,1), lwd = 2, pch = 19,
xlim = c(-1.5,1.5), ylim = c(-0.5, 1.5), asp = 1, ylab = "", xlab = "", axes = FALSE)
axis(1, at = -2:2)
axis(2, at = -1:1)
box()
lines(c(-3,3), c(0,0), lty = 2, lwd = 0.2)
lines(c(-3,3), c(1,1), lty = 2, lwd = 0.2)
lines(c(0,0), c(-3,3), lty = 2, lwd = 0.2)
lines(c(1,1), c(-3,3), lty = 2, lwd = 0.2)
lines(c(-1,-1), c(-3,3), lty = 2, lwd = 0.2)
lines(c(-1,1), c(0,0), lwd = 3, lty = 1)
lines(c(0,1), c(0,1), lwd = 3, lty = 1)
lines(c(0,-1), c(0,1), lwd = 3, lty = 1)
lines(c(0,0), c(0,1), lwd = 3, lty = 1)
lines(c(0,4), c(0,2), lwd = 1, lty = 2)
lines(c(0,2), c(0,4), lwd = 1, lty = 2)
lines(c(0,-2), c(0,4), lwd = 1, lty = 2)
lines(c(0,-4), c(0,2), lwd = 1, lty = 2)
lines(c(-4,4), c(0,0), lwd = 1, lty = 2)
text(0,1.2,"ekjcxbdcx")
text(0,1.2,"|m|>2")
plot(c(-1,0,1,-1,0,1),c(0,0,0,1,1,1), lwd = 2, pch = 19,
xlim = c(-1.5,1.5), ylim = c(-0.5, 1.5), asp = 1, ylab = "", xlab = "", axes = FALSE)
axis(1, at = -2:2)
axis(2, at = -1:1)
box()
lines(c(-3,3), c(0,0), lty = 2, lwd = 0.2)
lines(c(-3,3), c(1,1), lty = 2, lwd = 0.2)
lines(c(0,0), c(-3,3), lty = 2, lwd = 0.2)
lines(c(1,1), c(-3,3), lty = 2, lwd = 0.2)
lines(c(-1,-1), c(-3,3), lty = 2, lwd = 0.2)
lines(c(-1,1), c(0,0), lwd = 3, lty = 1)
lines(c(0,1), c(0,1), lwd = 3, lty = 1)
lines(c(0,-1), c(0,1), lwd = 3, lty = 1)
lines(c(0,0), c(0,1), lwd = 3, lty = 1)
lines(c(0,4), c(0,2), lwd = 1, lty = 2)
lines(c(0,2), c(0,4), lwd = 1, lty = 2)
lines(c(0,-2), c(0,4), lwd = 1, lty = 2)
lines(c(0,-4), c(0,2), lwd = 1, lty = 2)
lines(c(-4,4), c(0,0), lwd = 1, lty = 2)
text(0,1.2,"|m|>2")
plot(c(-1,0,1,-1,0,1),c(0,0,0,1,1,1), lwd = 2, pch = 19,
xlim = c(-1.5,1.5), ylim = c(-0.5, 1.5), asp = 1, ylab = "", xlab = "", axes = FALSE)
axis(1, at = -2:2)
axis(2, at = -1:1)
box()
lines(c(-3,3), c(0,0), lty = 2, lwd = 0.2)
lines(c(-3,3), c(1,1), lty = 2, lwd = 0.2)
lines(c(0,0), c(-3,3), lty = 2, lwd = 0.2)
lines(c(1,1), c(-3,3), lty = 2, lwd = 0.2)
lines(c(-1,-1), c(-3,3), lty = 2, lwd = 0.2)
lines(c(-1,1), c(0,0), lwd = 3, lty = 1)
lines(c(0,1), c(0,1), lwd = 3, lty = 1)
lines(c(0,-1), c(0,1), lwd = 3, lty = 1)
lines(c(0,0), c(0,1), lwd = 3, lty = 1)
lines(c(0,4), c(0,2), lwd = 1, lty = 2)
lines(c(0,2), c(0,4), lwd = 1, lty = 2)
lines(c(0,-2), c(0,4), lwd = 1, lty = 2)
lines(c(0,-4), c(0,2), lwd = 1, lty = 2)
lines(c(-4,4), c(0,0), lwd = 1, lty = 2)
text(0,1.2,"|m| > 2")
plot(c(-1,0,1,-1,0,1),c(0,0,0,1,1,1), lwd = 2, pch = 19,
xlim = c(-1.5,1.5), ylim = c(-0.5, 1.5), asp = 1, ylab = "", xlab = "", axes = FALSE)
axis(1, at = -2:2)
axis(2, at = -1:1)
box()
lines(c(-3,3), c(0,0), lty = 2, lwd = 0.2)
lines(c(-3,3), c(1,1), lty = 2, lwd = 0.2)
lines(c(0,0), c(-3,3), lty = 2, lwd = 0.2)
lines(c(1,1), c(-3,3), lty = 2, lwd = 0.2)
lines(c(-1,-1), c(-3,3), lty = 2, lwd = 0.2)
lines(c(-1,1), c(0,0), lwd = 3, lty = 1)
lines(c(0,1), c(0,1), lwd = 3, lty = 1)
lines(c(0,-1), c(0,1), lwd = 3, lty = 1)
lines(c(0,0), c(0,1), lwd = 3, lty = 1)
lines(c(0,4), c(0,2), lwd = 1, lty = 2)
lines(c(0,2), c(0,4), lwd = 1, lty = 2)
lines(c(0,-2), c(0,4), lwd = 1, lty = 2)
lines(c(0,-4), c(0,2), lwd = 1, lty = 2)
lines(c(-4,4), c(0,0), lwd = 1, lty = 2)
text(0,1.4,"|m| > 2")
plot(c(-1,0,1,-1,0,1),c(0,0,0,1,1,1), lwd = 2, pch = 19,
xlim = c(-1.5,1.5), ylim = c(-0.5, 1.5), asp = 1, ylab = "", xlab = "", axes = FALSE)
axis(1, at = -2:2)
axis(2, at = -1:1)
box()
lines(c(-3,3), c(0,0), lty = 2, lwd = 0.2)
lines(c(-3,3), c(1,1), lty = 2, lwd = 0.2)
lines(c(0,0), c(-3,3), lty = 2, lwd = 0.2)
lines(c(1,1), c(-3,3), lty = 2, lwd = 0.2)
lines(c(-1,-1), c(-3,3), lty = 2, lwd = 0.2)
lines(c(-1,1), c(0,0), lwd = 3, lty = 1)
lines(c(0,1), c(0,1), lwd = 3, lty = 1)
lines(c(0,-1), c(0,1), lwd = 3, lty = 1)
lines(c(0,0), c(0,1), lwd = 3, lty = 1)
lines(c(0,4), c(0,2), lwd = 1, lty = 2)
lines(c(0,2), c(0,4), lwd = 1, lty = 2)
lines(c(0,-2), c(0,4), lwd = 1, lty = 2)
lines(c(0,-4), c(0,2), lwd = 1, lty = 2)
lines(c(-4,4), c(0,0), lwd = 1, lty = 2)
text(0,1.3,"|m| > 2")
text(-1.7,1.2,"d")
text(-2,0.4,"d")
text(-1.7,1.2,"d")
text(1.7,1.25,"d")
text(2,0.4,"d")
plot(c(-1,0,1,-1,0,1),c(0,0,0,1,1,1), lwd = 2, pch = 19,
xlim = c(-1.5,1.5), ylim = c(-0.5, 1.5), asp = 1, ylab = "", xlab = "", axes = FALSE)
axis(1, at = -2:2)
axis(2, at = -1:1)
box()
lines(c(-3,3), c(0,0), lty = 2, lwd = 0.2)
lines(c(-3,3), c(1,1), lty = 2, lwd = 0.2)
lines(c(0,0), c(-3,3), lty = 2, lwd = 0.2)
lines(c(1,1), c(-3,3), lty = 2, lwd = 0.2)
lines(c(-1,-1), c(-3,3), lty = 2, lwd = 0.2)
lines(c(-1,1), c(0,0), lwd = 3, lty = 1)
lines(c(0,1), c(0,1), lwd = 3, lty = 1)
lines(c(0,-1), c(0,1), lwd = 3, lty = 1)
lines(c(0,0), c(0,1), lwd = 3, lty = 1)
lines(c(0,4), c(0,2), lwd = 1, lty = 2)
lines(c(0,2), c(0,4), lwd = 1, lty = 2)
lines(c(0,-2), c(0,4), lwd = 1, lty = 2)
lines(c(0,-4), c(0,2), lwd = 1, lty = 2)
lines(c(-4,4), c(0,0), lwd = 1, lty = 2)
text(0, 1.3,"|m| > 2")
text(-1.7,1.25,"-2 < m < -0.5")
plot(c(-1,0,1,-1,0,1),c(0,0,0,1,1,1), lwd = 2, pch = 19,
xlim = c(-1.5,1.5), ylim = c(-0.5, 1.5), asp = 1, ylab = "", xlab = "", axes = FALSE)
axis(1, at = -2:2)
axis(2, at = -1:1)
box()
lines(c(-3,3), c(0,0), lty = 2, lwd = 0.2)
lines(c(-3,3), c(1,1), lty = 2, lwd = 0.2)
lines(c(0,0), c(-3,3), lty = 2, lwd = 0.2)
lines(c(1,1), c(-3,3), lty = 2, lwd = 0.2)
lines(c(-1,-1), c(-3,3), lty = 2, lwd = 0.2)
lines(c(-1,1), c(0,0), lwd = 3, lty = 1)
lines(c(0,1), c(0,1), lwd = 3, lty = 1)
lines(c(0,-1), c(0,1), lwd = 3, lty = 1)
lines(c(0,0), c(0,1), lwd = 3, lty = 1)
lines(c(0,4), c(0,2), lwd = 1, lty = 2)
lines(c(0,2), c(0,4), lwd = 1, lty = 2)
lines(c(0,-2), c(0,4), lwd = 1, lty = 2)
lines(c(0,-4), c(0,2), lwd = 1, lty = 2)
lines(c(-4,4), c(0,0), lwd = 1, lty = 2)
text(0, 1.3,"|m| > 2")
text(-1.6,1.25,"-2 < m < -0.5")
text(-2,0.4,"-0.5 < m < 0")
text(1.6,1.25,"0.5 < m < 2")
text(2,0.4,"0 < m < 0.5")
plot(c(-1,0,1,-1,0,1),c(0,0,0,1,1,1), lwd = 2, pch = 19,
xlim = c(-1.5,1.5), ylim = c(-0.3, 1.7), asp = 1, ylab = "", xlab = "", axes = FALSE)
axis(1, at = -2:2)
axis(2, at = -1:1)
box()
lines(c(-3,3), c(0,0), lty = 2, lwd = 0.2)
lines(c(-3,3), c(1,1), lty = 2, lwd = 0.2)
lines(c(0,0), c(-3,3), lty = 2, lwd = 0.2)
lines(c(1,1), c(-3,3), lty = 2, lwd = 0.2)
lines(c(-1,-1), c(-3,3), lty = 2, lwd = 0.2)
lines(c(-1,1), c(0,0), lwd = 3, lty = 1)
lines(c(0,1), c(0,1), lwd = 3, lty = 1)
lines(c(0,-1), c(0,1), lwd = 3, lty = 1)
lines(c(0,0), c(0,1), lwd = 3, lty = 1)
lines(c(0,4), c(0,2), lwd = 1, lty = 2)
lines(c(0,2), c(0,4), lwd = 1, lty = 2)
lines(c(0,-2), c(0,4), lwd = 1, lty = 2)
lines(c(0,-4), c(0,2), lwd = 1, lty = 2)
lines(c(-4,4), c(0,0), lwd = 1, lty = 2)
text(0, 1.3,"|m| > 2")
text(-1.6,1.25,"-2 < m < -0.5")
text(-2,0.4,"-0.5 < m < 0")
text(1.6,1.25,"0.5 < m < 2")
text(2,0.4,"0 < m < 0.5")
library(permute)
library(deldir)
library(Matrix)
library(MatchIt)
library(fpc)
library(data.table)
library(cluster)
library(proxy)
library(e1071)
library(progress)
library(ggplot2)
library(gridExtra)
library(e1071)
library(mvtnorm)
library(matrixStats)
library(clue)
library(label.switching)
library(gtools)
library(psych)
library(MASS)
library(Polychrome)
set.seed(1234)
source("functions/compute_local_representative.R")
source("functions/BVKMA.R")
source("functions/boot_iter.R")
source("functions/compute_eta.R")
source("functions/compute_theta.R")
source("functions/generate_data.R")
source("functions/kpi.R")
source("functions/plot_grid.R")
source("functions/clr.R")
source("functions/firstder.R")
gridSizeX = 50
gridSizeY = 50
numNodes = gridSizeX * gridSizeY
natt = 187
B = 100
grid = expand.grid(x = 1:gridSizeX, y = 1:gridSizeY)
# easy : -2, 2, 1, 0.75
# hard : -10, 10, 3, 0.3
minshift = -10
maxshift = 10
sigma_f = 3  ## amplitude
scale = 0.3   ## bigger --> smooth
d = generate_data(gridSizeX, gridSizeY, natt, sigma_f, scale, minshift, maxshift)
original_data = d$data
real_labels  = d$real_labels
data = original_data
n = 50
k = 4
print = FALSE
grid_points = expand.grid(x = 1:gridSizeX, y = 1:gridSizeY)
seed_points = grid_points[sample(nrow(grid_points), n),]
distances = proxy::dist(grid_points[,c(1,2)], seed_points)
grid_points$cell = apply(distances, 1, which.min)
tess = deldir(seed_points$x, seed_points$y)
plot(tess, wlines = "tess")
title("Voronoi tesselation")
points(seed_points, pch = 20, col = "red")
points(grid_points$x, grid_points$y, pch = 1, col = as.factor(grid_points$cell))
tess = deldir(seed_points$x, seed_points$y)
plot(tess)
title("Voronoi tesselation")
points(seed_points, pch = 20, col = "red")
points(grid_points$x, grid_points$y, pch = 1, col = as.factor(grid_points$cell))
tess = deldir(seed_points$x, seed_points$y)
plot(tess, wlines = "tess")
title("Voronoi tesselation")
points(seed_points, pch = 20, col = "red")
points(grid_points$x, grid_points$y, pch = 1, col = as.factor(grid_points$cell))
local_representatives = compute_local_representative(data, grid_points, seed_points)
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
kmeans_representatives = kmeans(local_representatives, k, nstart = 30, iter.max = 100)
cluster_assignment = kmeans_representatives$cluster
single_cluster = cluster_assignment[grid_points$cell]
order = as.numeric(names(sort(table(single_cluster), decreasing = TRUE)))
cl = numeric(length(single_cluster))
for(i in order){
ind = which(single_cluster == i)
cl[ind] = which(order == i)
}
labels = cl
plot_grid(gridSizeX, gridSizeY, labels, title = "", scaled = 0,
centroids = FALSE, data, title_centr = "",
original = FALSE, original_data)
seed_points = grid_points[sample(nrow(grid_points), n),]
distances = proxy::dist(grid_points[,c(1,2)], seed_points)
tess = deldir(seed_points$x, seed_points$y)
plot(tess, wlines = "tess")
title("Voronoi tesselation")
points(seed_points, pch = 20, col = "red")
points(grid_points$x, grid_points$y, pch = 1, col = as.factor(grid_points$cell))
grid_points = expand.grid(x = 1:gridSizeX, y = 1:gridSizeY)
seed_points = grid_points[sample(nrow(grid_points), n),]
distances = proxy::dist(grid_points[,c(1,2)], seed_points)
grid_points$cell = apply(distances, 1, which.min)
tess = deldir(seed_points$x, seed_points$y)
plot(tess, wlines = "tess")
title("Voronoi tesselation")
points(seed_points, pch = 20, col = "red")
points(grid_points$x, grid_points$y, pch = 1, col = as.factor(grid_points$cell))
plot_grid(gridSizeX, gridSizeY, grid_points$cell, title = "", scaled = 0,
centroids = FALSE, data, title_centr = "",
original = FALSE, original_data)
points(seed_points)
grid_points = expand.grid(x = 1:gridSizeX, y = 1:gridSizeY)
seed_points = grid_points[sample(nrow(grid_points), n),]
distances = proxy::dist(grid_points[,c(1,2)], seed_points)
grid_points$cell = apply(distances, 1, which.min)
plot_grid(gridSizeX, gridSizeY, grid_points$cell, title = "", scaled = 0,
centroids = FALSE, data, title_centr = "",
original = FALSE, original_data)
seed_points = grid_points[sample(nrow(grid_points), n),]
distances = proxy::dist(grid_points[,c(1,2)], seed_points)
grid_points = expand.grid(x = 1:gridSizeX, y = 1:gridSizeY)
seed_points = grid_points[sample(nrow(grid_points), n),]
distances = proxy::dist(grid_points[,c(1,2)], seed_points)
grid_points$cell = apply(distances, 1, which.min)
plot_grid(gridSizeX, gridSizeY, grid_points$cell, title = "", scaled = 0,
centroids = FALSE, data, title_centr = "",
original = FALSE, original_data)
grid_points = expand.grid(x = 1:gridSizeX, y = 1:gridSizeY)
seed_points = grid_points[sample(nrow(grid_points), n),]
distances = proxy::dist(grid_points[,c(1,2)], seed_points)
grid_points$cell = apply(distances, 1, which.min)
plot_grid(gridSizeX, gridSizeY, grid_points$cell, title = "", scaled = 0,
centroids = FALSE, data, title_centr = "",
original = FALSE, original_data)
grid_points = expand.grid(x = 1:gridSizeX, y = 1:gridSizeY)
seed_points = grid_points[sample(nrow(grid_points), n),]
distances = proxy::dist(grid_points[,c(1,2)], seed_points)
grid_points$cell = apply(distances, 1, which.min)
plot_grid(gridSizeX, gridSizeY, grid_points$cell, title = "", scaled = 0,
centroids = FALSE, data, title_centr = "",
original = FALSE, original_data)
local_representatives = compute_local_representative(data, grid_points, seed_points)
kmeans_representatives = kmeans(local_representatives, k, nstart = 30, iter.max = 100)
cluster_assignment = kmeans_representatives$cluster
single_cluster = cluster_assignment[grid_points$cell]
order = as.numeric(names(sort(table(single_cluster), decreasing = TRUE)))
cl = numeric(length(single_cluster))
for(i in order){
ind = which(single_cluster == i)
cl[ind] = which(order == i)
}
plot_grid(gridSizeX, gridSizeY, cl, title = "", scaled = 0,
centroids = FALSE, data, title_centr = "",
original = FALSE, original_data)
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
random_cell = sample(1:n, size = 1)
matplot(t(data[which(grid_points$cell == random_cell),]), type = 'l', col = 'grey', lwd = 1, lty = 2)
ind = as.numeric(rownames(seed_points[random_cell,]))
matlines(t(data[ind,]), type = 'l', col = 'forestgreen', lwd = 3, lty = 1)
matlines(t(local_representatives[random_cell,]), type = 'l', col = 'red', lwd = 3, lty = 1)
legend("bottomright", legend = c("Observations", "Local nucleus", "Local Representative"), col = c("black", "forestgreen", "red"), lty = c(2,1,1), lwd = c(1,3,3))
